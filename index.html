<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO (ê²€ìƒ‰ ì—”ì§„ ìµœì í™”) ë©”íƒ€ íƒœê·¸ -->
    <title>8 ìˆ«ì í¼ì¦ ê²Œì„ - ì˜¨ë¼ì¸ ë¬´ë£Œ 8-Puzzle</title>
    <meta name="description" content="ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ì¦ê¸°ëŠ” 8 ìŠ¬ë¼ì´ë”© í¼ì¦ ê²Œì„ì…ë‹ˆë‹¤. ìˆ«ì 1ë¶€í„° 8ê¹Œì§€ ìˆœì„œëŒ€ë¡œ ë°°ì—´í•˜ëŠ” ë‘ë‡Œ íŠ¸ë ˆì´ë‹ ê²Œì„ì„ ë¬´ë£Œë¡œ ì²´í—˜í•˜ì„¸ìš”.">
    <meta name="keywords" content="ìˆ«ìí¼ì¦, ìŠ¬ë¼ì´ë”©í¼ì¦, 8-Puzzle, ë‘ë‡Œê²Œì„, í¼ì¦ê²Œì„, ë¬´ë£Œê²Œì„">
    <meta name="author" content="Your Name">
    
    <!-- Open Graph (ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ  ìµœì í™”) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="8 ìˆ«ì í¼ì¦ ê²Œì„">
    <meta property="og:description" content="ìˆ«ì 1ë¶€í„° 8ê¹Œì§€ ìˆœì„œëŒ€ë¡œ ë§ì¶”ëŠ” 8 ìˆ«ì í¼ì¦ ê²Œì„.">
    <meta property="og:image" content="https://picsum.photos/seed/puzzle/800/400">

    <style>
        /* CSS ìŠ¤íƒ€ì¼ */
        :root {
            --bg-color: #f0f2f5;
            --text-color: #333;
            --tile-bg: #4a90e2;
            --tile-text: #ffffff;
            --empty-bg: #d1d5db;
            --container-width: 320px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            color: #2c3e50;
        }

        p {
            color: #666;
            margin-top: 10px;
        }

        /* ê²Œì„ ë³´ë“œ ì»¨í…Œì´ë„ˆ */
        #game-container {
            width: var(--container-width);
            height: var(--container-width);
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
        #grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            width: 100%;
            height: 100%;
        }

        /* íƒ€ì¼ ìŠ¤íƒ€ì¼ */
        .tile {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--tile-bg);
            color: var(--tile-text);
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s, transform 0.1s;
        }

        .tile:hover {
            background-color: #357abd;
        }

        .tile:active {
            transform: scale(0.95);
        }

        /* ë¹ˆì¹¸ ìŠ¤íƒ€ì¼ */
        .tile.empty {
            background-color: transparent;
            cursor: default;
            pointer-events: none; /* í´ë¦­ ë°©ì§€ */
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 1rem;
            background-color: #2c3e50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #34495e;
        }

        /* ì™„ë£Œ ë©”ì‹œì§€ */
        #message {
            margin-top: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #27ae60;
            min-height: 1.5em;
        }

        footer {
            margin-top: 40px;
            font-size: 0.8rem;
            color: #888;
        }

        /* ì–¸ì–´ ì „í™˜ UI ìŠ¤íƒ€ì¼ */
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 5px;
        }

        .lang-btn {
            padding: 5px 10px;
            background-color: #f0f2f5;
            border: 1px solid #d1d5db;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            background-color: #e5e7eb;
        }

        .lang-btn.active {
            background-color: #4a90e2;
            color: white;
            border-color: #357abd;
        }

        @media (max-width: 768px) {
            .language-switcher {
                position: static;
                margin-top: 10px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>

    <!-- ì–¸ì–´ ì „í™˜ UI -->
    <div class="language-switcher">
        <button class="lang-btn active" data-lang="ko">í•œêµ­ì–´</button>
        <button class="lang-btn" data-lang="en">English</button>
        <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
        <button class="lang-btn" data-lang="ja">æ—¥æœ¬èª</button>
    </div>

    <header>
        <h1 id="title">3Ã—3 ìˆ«ì í¼ì¦</h1>
        <p id="description">ë¹ˆì¹¸ì„ ì´ìš©í•˜ì—¬ ìˆ«ì 1~8ì„ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ì„¸ìš”.</p>
    </header>

    <main>
        <div id="game-container">
            <div id="grid">
                <!-- íƒ€ì¼ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
        
        <div id="message"></div>

        <div class="controls">
            <button id="shuffle-btn" onclick="initGame()">ê²Œì„ ì„ê¸° (ë‹¤ì‹œ ì‹œì‘)</button>
        </div>
    </main>

    <footer id="footer">
        &copy; 2024 8-Puzzle Game. All rights reserved.
    </footer>

    <script>
        // ë‹¤êµ­ì–´ ì§€ì› ë³€ìˆ˜
        let currentLanguage = 'ko'; // ê¸°ë³¸ ì–¸ì–´ëŠ” í•œêµ­ì–´

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                title: "8 ìˆ«ì í¼ì¦",
                description: "ë¹ˆì¹¸ì„ ì´ìš©í•˜ì—¬ ìˆ«ì 1~8ì„ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ì„¸ìš”.",
                shuffleBtn: "ê²Œì„ ì„ê¸° (ë‹¤ì‹œ ì‹œì‘)",
                winMessage: "ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ì„±ê³µí–ˆìŠµë‹ˆë‹¤!",
                footer: "Â© 2024 8-Puzzle Game. All rights reserved.",
                langBtnKo: "í•œêµ­ì–´",
                langBtnEn: "English",
                langBtnZh: "ä¸­æ–‡",
                langBtnJa: "æ—¥æœ¬èª"
            },
            en: {
                title: "8 Number Puzzle",
                description: "Arrange numbers 1-8 in order using the empty space.",
                shuffleBtn: "Shuffle Game (Restart)",
                winMessage: "ğŸ‰ Congratulations! You solved it!",
                footer: "Â© 2024 8-Puzzle Game. All rights reserved.",
                langBtnKo: "Korean",
                langBtnEn: "English",
                langBtnZh: "Chinese",
                langBtnJa: "Japanese"
            },
            zh: {
                title: "8 æ•°å­—æ‹¼å›¾",
                description: "ä½¿ç”¨ç©ºç™½ç©ºé—´å°†æ•°å­—1-8æŒ‰é¡ºåºæ’åˆ—ã€‚",
                shuffleBtn: "é‡æ–°æ´—ç‰Œ (é‡æ–°å¼€å§‹)",
                winMessage: "ğŸ‰ æ­å–œï¼ä½ æˆåŠŸäº†ï¼",
                footer: "Â© 2024 8-Puzzle Game. All rights reserved.",
                langBtnKo: "éŸ©è¯­",
                langBtnEn: "è‹±è¯­",
                langBtnZh: "ä¸­æ–‡",
                langBtnJa: "æ—¥è¯­"
            },
            ja: {
                title: "8 æ•°å­—ãƒ‘ã‚ºãƒ«",
                description: "ç©ºãã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½¿ã£ã¦1ã€œ8ã®æ•°å­—ã‚’é †ç•ªã«ä¸¦ã¹ã¾ã™ã€‚",
                shuffleBtn: "ã‚²ãƒ¼ãƒ ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ« (å†é–‹)",
                winMessage: "ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼æˆåŠŸã—ã¾ã—ãŸï¼",
                footer: "Â© 2024 8-Puzzle Game. All rights reserved.",
                langBtnKo: "éŸ“å›½èª",
                langBtnEn: "è‹±èª",
                langBtnZh: "ä¸­å›½èª",
                langBtnJa: "æ—¥æœ¬èª"
            }
        };

        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        // 1~8ì€ ìˆ«ì íƒ€ì¼, 0ì€ ë¹ˆì¹¸ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
        let board = [];
        const gridSize = 3;

        // ì–¸ì–´ ê°ì§€ ë° ì„¤ì • í•¨ìˆ˜
        function detectBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            const supportedLangs = ['ko', 'en', 'zh', 'ja'];

            // ì–¸ì–´ ì½”ë“œ ì• 2ê¸€ìë§Œ í™•ì¸ (ì˜ˆ: 'ko-KR' -> 'ko')
            const langCode = browserLang.split('-')[0];

            // ì§€ì›í•˜ëŠ” ì–¸ì–´ì¸ì§€ í™•ì¸
            if (supportedLangs.includes(langCode)) {
                return langCode;
            }

            // ê¸°ë³¸ ì–¸ì–´ë¡œ í•œêµ­ì–´ ë°˜í™˜
            return 'ko';
        }

        // ì–¸ì–´ ì„¤ì • í•¨ìˆ˜
        function setLanguage(lang) {
            if (!translations[lang]) return;

            currentLanguage = lang;

            // HTML lang ì†ì„± ì—…ë°ì´íŠ¸
            document.documentElement.lang = lang;

            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateTexts();

            // ì–¸ì–´ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
            updateLanguageButtons();

            // ì–¸ì–´ ì„¤ì • ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            localStorage.setItem('preferredLanguage', lang);
        }

        // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateTexts() {
            const t = translations[currentLanguage];

            document.getElementById('title').textContent = t.title;
            document.getElementById('description').textContent = t.description;
            document.getElementById('shuffle-btn').textContent = t.shuffleBtn;
            document.getElementById('footer').textContent = t.footer;

            // ì–¸ì–´ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.querySelector('.lang-btn[data-lang="ko"]').textContent = t.langBtnKo;
            document.querySelector('.lang-btn[data-lang="en"]').textContent = t.langBtnEn;
            document.querySelector('.lang-btn[data-lang="zh"]').textContent = t.langBtnZh;
            document.querySelector('.lang-btn[data-lang="ja"]').textContent = t.langBtnJa;
        }

        // ì–¸ì–´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.getAttribute('data-lang') === currentLanguage) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        // DOM ìš”ì†Œ ì°¸ì¡°
        const gridElement = document.getElementById('grid');
        const messageElement = document.getElementById('message');

        // ê²Œì„ ì´ˆê¸°í™” í•¨ìˆ˜
        function initGame() {
            // 1. ì™„ì„±ëœ ìƒíƒœë¡œ ì‹œì‘ [1, 2, 3, 4, 5, 6, 7, 8, 0]
            board = Array.from({length: gridSize * gridSize}, (_, i) => (i + 1) % 9);
            
            // 2. ì„ê¸° (ëœë¤í•˜ê²Œ ì´ë™ì‹œì¼œì„œ ì„ëŠ” ê²ƒì´ í’€ ìˆ˜ ìˆëŠ” í¼ì¦ì„ ë³´ì¥í•¨)
            shuffleBoard();
            
            // 3. ë Œë”ë§
            renderBoard();
            messageElement.textContent = '';
        }

        // ë³´ë“œ ì„ê¸° í•¨ìˆ˜ (ì™„ì „ ëœë¤ ë°°ì—´ì€ í’€ ìˆ˜ ì—†ëŠ” ê²½ìš°ê°€ ìƒê¸°ë¯€ë¡œ, ì‹¤ì œ ì´ë™ìœ¼ë¡œ ì„ìŒ)
        function shuffleBoard() {
            let previousIndex = -1;
            const shuffleCount = 150; // ì„ëŠ” íšŸìˆ˜

            for (let i = 0; i < shuffleCount; i++) {
                const emptyIdx = board.indexOf(0);
                const neighbors = getNeighbors(emptyIdx);
                
                // ë°”ë¡œ ì´ì „ ì¹¸ìœ¼ë¡œ ë‹¤ì‹œ ëŒì•„ê°€ì§€ ì•Šë„ë¡ í•„í„°ë§ (ì„ê¸° íš¨ê³¼ë¥¼ ìœ„í•´)
                const validNeighbors = neighbors.filter(idx => idx !== previousIndex);
                
                // ì´ì›ƒ ì¤‘ í•˜ë‚˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ íƒ
                const randomNeighbor = validNeighbors[Math.floor(Math.random() * validNeighbors.length)];
                
                // ìŠ¤ì™‘
                [board[emptyIdx], board[randomNeighbor]] = [board[randomNeighbor], board[emptyIdx]];
                previousIndex = emptyIdx;
            }
        }

        // íŠ¹ì • ì¸ë±ìŠ¤ì˜ ì´ì›ƒ íƒ€ì¼ ì¸ë±ìŠ¤ë“¤ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜
        function getNeighbors(index) {
            const neighbors = [];
            const row = Math.floor(index / gridSize);
            const col = index % gridSize;

            if (row > 0) neighbors.push(index - gridSize); // ìƒ
            if (row < gridSize - 1) neighbors.push(index + gridSize); // í•˜
            if (col > 0) neighbors.push(index - 1); // ì¢Œ
            if (col < gridSize - 1) neighbors.push(index + 1); // ìš°

            return neighbors;
        }

        // í™”ë©´ì— ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
        function renderBoard() {
            gridElement.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

            board.forEach((number, index) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                
                if (number === 0) {
                    tile.classList.add('empty');
                } else {
                    tile.textContent = number;
                    // í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
                    tile.onclick = () => moveTile(index);
                }
                
                gridElement.appendChild(tile);
            });
        }

        // íƒ€ì¼ ì´ë™ ì²˜ë¦¬ í•¨ìˆ˜
        function moveTile(index) {
            const emptyIdx = board.indexOf(0);
            const neighbors = getNeighbors(emptyIdx);

            // í´ë¦­í•œ íƒ€ì¼ì´ ë¹ˆì¹¸ì˜ ì´ì›ƒì´ë©´ ì´ë™ ê°€ëŠ¥
            if (neighbors.includes(index)) {
                // ìŠ¤ì™‘
                [board[emptyIdx], board[index]] = [board[index], board[emptyIdx]];
                
                renderBoard();
                checkWin();
            }
        }

        // ìŠ¹ë¦¬ ì¡°ê±´ í™•ì¸
        function checkWin() {
            // ëª©í‘œ ìƒíƒœ: [1, 2, 3, 4, 5, 6, 7, 8, 0]
            const isWin = board.every((val, index) => {
                if (index === board.length - 1) return val === 0;
                return val === index + 1;
            });

            if (isWin) {
                messageElement.textContent = translations[currentLanguage].winMessage;
            }
        }

        // í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜
        function initializePage() {
            // 1. ì–¸ì–´ ì„¤ì • (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ > ë¸Œë¼ìš°ì € ê°ì§€ > ê¸°ë³¸ê°’)
            const savedLang = localStorage.getItem('preferredLanguage');
            const browserLang = detectBrowserLanguage();
            const initialLang = savedLang || browserLang || 'ko';

            setLanguage(initialLang);

            // 2. ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const lang = this.getAttribute('data-lang');
                    setLanguage(lang);
                });
            });

            // 3. ê²Œì„ ì‹œì‘
            initGame();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = initializePage;
    </script>
</body>
</html>
